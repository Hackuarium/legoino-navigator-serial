<html>
  <head>
    <script src="./fifo-logger.js"></script>
    <script src="./logger.js"></script>
    <script src="./devicesToTable.js"></script>
    <script src="./grbl.js"></script>
    <script src="../dist/legoino-navigator-serial.js"></script>
  </head>
  <body>
    <div>
      <p>
        <button onclick="devicesManager.updateDevices()">updateDevices</button>
        <button onclick="devicesManager.requestDevices()">
          requestDevices
        </button>
        <input
          type="text"
          value=""
          id="command"
          onkeypress="checkEnter(event)"
        />
        <button onclick="sendCommand(document.getElementById('command').value)">
          sendCommand
        </button>
        <script>
          function checkEnter(event) {
            if (event.keyCode === 13 || event.keyCode === 10) {
              const command = document.getElementById('command');
              sendCommand(command.value);
              command.value = '';
            }
          }
        </script>
      </p>
      <div style="display: flex; flex-direction: row">
        <div>
          <p>
            <button onclick="sendCommand('$$')">Print settings</button>
            <button onclick="sendCommand('$#')">Print parameters</button>
            <button onclick="sendCommand('~')">~ cycle start/resume</button>
            <button onclick="sendCommand('!')">! Feed hold</button>
          </p>

          <p>
            <button onclick="sendCommand(String.fromCharCode(0x18))">
              ctrl-x
            </button>
            <button onclick="sendCommand('?')">? Status</button>
            <button onclick="sendCommand('~')">~ cycle start/resume</button>
            <button onclick="sendCommand('!')">! Feed hold</button>
          </p>
          <p>
            <button onclick="sendCommand('G0 X0 Y0 Z0')">G0 X0 Y0 Z0</button>
            <button onclick="sendCommand('G0 X100 Y0 Z0')">
              G0 X100 Y0 Z0
            </button>
            <button onclick="sendCommand('G0 X0 Y100 Z0')">
              G0 X0 Y100 Z0
            </button>
            <button onclick="sendCommand('G0 X0 Y0 Z100')">
              G0 X0 Y0 Z100
            </button>
          </p>
        </div>
        <div style="background-color: lightgreen">
          <h2>Command</h2>
          <p>
            X:
            <button onclick="sendCommand('X'+(status.info.MPos[0]-100))">
              -100
            </button>
            <button onclick="sendCommand('X'+(status.info.MPos[0]-10))">
              -10
            </button>
            <button onclick="sendCommand('X0')">Home</button>
            <button onclick="sendCommand('X'+(status.info.MPos[0]+10))">
              +10
            </button>
            <button onclick="sendCommand('X'+(status.info.MPos[0]+100))">
              +100
            </button>
          </p>
          <p>
            Y:
            <button onclick="sendCommand('Y'+(status.info.MPos[1]-100))">
              -100
            </button>
            <button onclick="sendCommand('Y'+(status.info.MPos[1]-10))">
              -10
            </button>
            <button onclick="sendCommand('Y0')">Home</button>
            <button onclick="sendCommand('Y'+(status.info.MPos[1]+10))">
              +10
            </button>
            <button onclick="sendCommand('Y'+(status.info.MPos[1]+100))">
              +100
            </button>
          </p>
          <p>
            Z:
            <button onclick="sendCommand('Z'+(status.info.MPos[2]-100))">
              -100
            </button>
            <button onclick="sendCommand('Z'+(status.info.MPos[2]-10))">
              -10
            </button>
            <button onclick="sendCommand('Z0')">Home</button>
            <button onclick="sendCommand('Z'+(status.info.MPos[2]+10))">
              +10
            </button>
            <button onclick="sendCommand('Z'+(status.info.MPos[2]+100))">
              +100
            </button>
          </p>
        </div>
      </div>
    </div>

    <div style="display: flex; flex-direction: row" ;>
      <div
        id="terminal"
        style="
          background-color: black;
          font-family: 'Courier New', Courier, monospace;
          font-size: 14px;
          overflow: auto;
          height: 300px;
          width: 700px;
          display: flex;
          flex-direction: column-reverse;
        "
      ></div>
      <div
        style="background-color: lightyellow; overflow: auto; height: 400px"
        id="status"
      ></div>
      <div
        style="background-color: pink; overflow: auto; height: 400px"
        id="settings"
      ></div>
    </div>
    <div style="display: flex; flex-direction: row">
      <div id="devices"></div>
      <div id="logs"></div>
    </div>
    <script src="./grbl.init.js"></script>
  </body>
</html>
